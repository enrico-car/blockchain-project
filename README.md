# Blockchain-project
This branch serves as a playground for testing the web3 module which allows the communication and integration of metamask with the local blockchain used for the blockchain project of a.y. 2024 - 2025.

## Requirements
Make sure to have npm, nodejs and hardhat.

Different modules are required, copy the following line:
```bash
npm install web3 http express hardhat @nomicfoundation/hardhat-toolbox
```

Hardhat will be used to host an ephemeral blockchain in particular, 20 wallets will be automatically generated all with some pre allocated ethereum.\
To start the network, run the following line:
```bash
npx hardhat node
```
The previous line will work as this branch already contains a hardhat projet.

In the case you want to created a new one, do this before:
```bash
npx hardhat init
```
and create a new javascript project making sure to installing also the project's dependencies with npm.

In order to deploy the contracts, in particular Counter.sol, run the following line:
```bash
npx hardhat run deploy.js --network localhost
```

This will deploy the contract and `return the address` of it.

## Connect metamask to local network
In the case you want to connect metamask to hardhat network or any local one, follow the following steps:

1. Open metamask

2. In the top left, click the network icon and select `Add a custom network`.

3. Fill all the fields (excluding the last one, URL Block Explorer). In particular, make sure to insert the correct Chain ID (can be obtained by running `index.js` or by looking at the hardhat output), put ETH as money symbol and `http://localhost:8545` as Default RPC URL.

4. In the main menu of metamask, add a new account. You can pass any of the 20 private key generated by hardhat.

Now you can use this account to make transactions trough the web page.

## Run the script

After starting the blockchain, you have two possibilities.

If you want to test the "offline" functionalities, simply run the following line:
```bash
node index.js
```

In the case you want to test the metamask integration, run the server following the command:
```bash
node server.js
```
and visit the web page at `http://localhost:3000`

## Possible errors
In the case it is not possible to use the smart contract from the web page, probably it hasn't been deployed or the addres / ABI has been changed with the latest deploymeny. In this case, check if the new address is the same as the one present in the server.js and also that ABI is equal (it can be found at artifacts/contracts/Counter.sol/Counter.json)